USE ReportServer;

SELECT R.Name [Report Name], S.Description [Subscription Description], S.LastRunTime [Last Run Time], S.LastStatus [Last Status],

SUBSTRING(S.Parameters,

CHARINDEX('YTracSiteID', S.Parameters)+25,

CHARINDEX('</Value>', S.Parameters, CHARINDEX('YTracSiteID', S.Parameters)) - CHARINDEX('YTracSiteID', S.Parameters)-25) [Site ID],

--CHARINDEX('YTracSiteID', S.Parameters)+25,

--CHARINDEX('</Value>', S.Parameters, CHARINDEX('YTracSiteID', S.Parameters)) [YTracSiteID],

CASE SUBSTRING(S.Parameters,

CHARINDEX('YTracSiteID', S.Parameters)+25,

CHARINDEX('</Value>', S.Parameters, CHARINDEX('YTracSiteID', S.Parameters)) - CHARINDEX('YTracSiteID', S.Parameters)-25)

WHEN 4 THEN 'Kansas'

WHEN 30 THEN 'Mississippi'

WHEN 70 THEN 'Tennessee'

WHEN 100 THEN 'Missouri'

WHEN 120 THEN 'Louisiana'

WHEN 140 THEN 'Wyoming'

WHEN 160 THEN 'Virginia'

WHEN 1000 THEN 'ZZ Test State'

ELSE 'UNKNOWN STATE' END [State],

O.UserName [Owner Name], M.UserName [Last Modified By], S.ModifiedDate [Modified Date],

S.SubscriptionID, S.Parameters, S.ExtensionSettings

--,S.*

FROM dbo.Subscriptions S

JOIN dbo.Catalog R ON R.ItemID = S.Report_OID

JOIN dbo.Users O ON O.UserID = S.OwnerID

JOIN dbo.Users M ON M.UserID = S.ModifiedByID

ORDER BY S.LastRunTime
